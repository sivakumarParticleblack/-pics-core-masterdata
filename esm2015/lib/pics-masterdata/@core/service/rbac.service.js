import { Injectable } from '@angular/core';
import { map } from 'rxjs/operators';
import { AccessManagementConfig, AttachmentConfig, MasterURL, PermissionsURL, PolicyGroupConfig, RoleConfig, UserConfig } from './../urls/rbac-url.config';
import * as i0 from "@angular/core";
import * as i1 from "./data-store.service";
export class RbacService {
    constructor(storeService) {
        this.storeService = storeService;
        this.storeService.currentStore.subscribe(val => {
            if (val) {
                this.httpService = val.HTTPSERVICE;
            }
        });
    }
    getAllUserList(key) {
        return this.httpService.get(`${UserConfig.EndPoint.User.getAllUserList}/${key}`);
    }
    getAllUserOrgList(orgid) {
        return this.httpService.get(UserConfig.EndPoint.User.getAllUserOrgList + orgid);
    }
    saveUser(data) {
        return this.httpService.post(UserConfig.EndPoint.User.createUser, data);
    }
    updateUser(data, userid) {
        return this.httpService.put(`${UserConfig.EndPoint.User.getAllUserList}/${userid}`, data);
    }
    deleteUser(id) {
        return this.httpService.delete(`${UserConfig.EndPoint.User.getAllUserList}/${id}`);
    }
    activateUser(data) {
        return this.httpService.post(UserConfig.EndPoint.User.activateUser, data);
    }
    addProviderUser(data) {
        return this.httpService.post(UserConfig.EndPoint.Provider.addProviderUser, data);
    }
    addUserRole(data) {
        return this.httpService.post(UserConfig.EndPoint.User.userRole, data);
    }
    uploadKey(objparams) {
        return this.httpService.post(AttachmentConfig.EndPoint.Attachments.UploadKey, objparams);
    }
    getOrgPolicyGroupList(orgid) {
        return this.httpService.get(PolicyGroupConfig.EndPoint.policyGroup.getOrgPolicyGroups.replace('{organizationid}', String(orgid)));
    }
    getAllPolicyGroupList(policyGroupId) {
        const endPoint = policyGroupId
            ? `${PolicyGroupConfig.EndPoint.policyGroup.getPolicyGroupList}/${policyGroupId}`
            : PolicyGroupConfig.EndPoint.policyGroup.getAllPolicyGroupList;
        return this.httpService.get(endPoint);
    }
    getPolicyGroupById(id) {
        return this.httpService.get(PolicyGroupConfig.EndPoint.policyGroup.getPolicyGroupList + '/' + id);
    }
    getPolicyGroupsByManagementGroup(policyGroupId) {
        return this.httpService.get(`/org/policyGroup/managementgroup/${policyGroupId}`);
    }
    createPolicyGroup(data) {
        return this.httpService.post(PolicyGroupConfig.EndPoint.policyGroup.createPolicyGroup, data);
    }
    updatePolicyGroup(id, item) {
        return this.httpService.put(`${PolicyGroupConfig.EndPoint.policyGroup.getPolicyGroupList}/${id}`, item);
    }
    deletePolicyGroup(id) {
        return this.httpService.delete(`${PolicyGroupConfig.EndPoint.policyGroup.getPolicyGroupList}/${id}`);
    }
    getAllUserRole(id) {
        return this.httpService.get(RoleConfig.EndPoint.role.getAllOrgRole.replace('{orgid}', String(id)));
    }
    deleteRole(id) {
        return this.httpService.delete(`${RoleConfig.EndPoint.role.getAllUserRole}/${id}`);
    }
    getRoleById(roleid) {
        return this.httpService.get(`${RoleConfig.EndPoint.role.getAllUserRole}/${roleid}`);
    }
    createRole(data) {
        return this.httpService.post(RoleConfig.EndPoint.role.createRole, data);
    }
    updateRole(roleId, data) {
        return this.httpService.put(`${RoleConfig.EndPoint.role.getAllUserRole}/${roleId}`, data);
    }
    getLandingPage(id) {
        return this.httpService.get(`${RoleConfig.EndPoint.role.getLandingPage}/${id}`);
    }
    createPolicyGroupForRole(roleId, data) {
        return this.httpService.post(`${RoleConfig.EndPoint.role.addPolicyGroup}/${roleId}/policygroups`, data);
    }
    updatePolicyGroupForRole(roleId, data) {
        return this.httpService.put(`${RoleConfig.EndPoint.role.addPolicyGroup}/${roleId}/policygroups`, data);
    }
    getReportDashbaord() {
        return this.httpService.get(`${RoleConfig.EndPoint.role.dossier}`);
    }
    getPermissionRoleById(id) {
        return this.httpService.get(PermissionsURL.EndPoints.permission.permissionRoleById.replace('{id}', id));
    }
    getManagementGroupTree(_organizationid) {
        return this.httpService.get('/org/management-group/organization/tree');
    }
    getPermissionsTree(applicationid) {
        return this.httpService.get(PermissionsURL.EndPoints.permission.applicationPermissionsTree.replace('{applicationid}', applicationid));
    }
    getPagePermission(data) {
        return this.httpService.post(PermissionsURL.EndPoints.permission.pagePermission, data);
    }
    createPage(page) {
        return this.httpService.post(PermissionsURL.EndPoints.page.createPage, page);
    }
    updatePage(page) {
        return this.httpService.put(PermissionsURL.EndPoints.page.updateDeletePage.replace('{pageid}', page.id), page);
    }
    deletePage(pageId) {
        return this.httpService.delete(PermissionsURL.EndPoints.page.updateDeletePage.replace('{pageid}', pageId));
    }
    getPermission(id) {
        return this.httpService.get(PermissionsURL.EndPoints.permission.getPermission.replace('{id}', id));
    }
    createPermission(permission) {
        return this.httpService.post(PermissionsURL.EndPoints.permission.createPermission, permission);
    }
    updatePermission(permission) {
        return this.httpService.put(PermissionsURL.EndPoints.permission.updateDeletePermission.replace('{permissionid}', permission.id), permission);
    }
    deletePermission(permissionId) {
        return this.httpService.delete(PermissionsURL.EndPoints.permission.updateDeletePermission.replace('{permissionid}', permissionId));
    }
    getAllPageTree(applicationid) {
        return this.httpService
            .get(PermissionsURL.EndPoints.page.AllPageTree.replace('{applicationid}', applicationid))
            .pipe(map((item) => {
            return item.data;
        }));
    }
    getPermissionTree(pageid, parentid) {
        return this.httpService.get(PermissionsURL.EndPoints.permission.getPermissionTree.replace('{pageid}', pageid).replace('{parentid}', parentid));
    }
    getPermissionTypes(applicationid) {
        return this.httpService.get(PermissionsURL.EndPoints.permission.getPermissionTypes.replace('{applicationid}', applicationid));
    }
    getOrganizationPage(orgId) {
        return this.httpService.get(AccessManagementConfig.EndPoint.Organization.getOrganization.replace('{orgId}', orgId));
    }
    createCategory(category) {
        return this.httpService.post(MasterURL.EndPoints.lookup.createCategory, category);
    }
    updateCategory(category) {
        return this.httpService.put(MasterURL.EndPoints.lookup.updateDeleteCategory.replace('{id}', category.id), category);
    }
    deleteCategory(categoryId) {
        return this.httpService.delete(MasterURL.EndPoints.lookup.updateDeleteCategory.replace('{id}', categoryId));
    }
    getLookup(id) {
        return this.httpService.get(MasterURL.EndPoints.lookup.lookup.replace('{id}', id));
    }
    createLookup(lookup) {
        return this.httpService.post(MasterURL.EndPoints.lookup.createLookup, lookup);
    }
    updateLookup(lookup) {
        return this.httpService.put(MasterURL.EndPoints.lookup.lookup.replace('{id}', lookup.id), lookup);
    }
    deleteLookup(lookupId) {
        return this.httpService.delete(MasterURL.EndPoints.lookup.lookup.replace('{id}', lookupId));
    }
    getAllCategoryTree(applicationid) {
        return this.httpService
            .get(MasterURL.EndPoints.lookup.getAllCategoryTree.replace('{applicationid}', applicationid))
            .pipe(map((item) => {
            return item.data;
        }));
    }
    getLookupTree(categoryid) {
        return this.httpService.get(MasterURL.EndPoints.lookup.getLookupTree.replace('{categoryid}', categoryid));
    }
    getLookupBycategoryID(categoryid) {
        return this.httpService.get(MasterURL.EndPoints.lookup.getLookupByCategoryId.replace('{id}', categoryid));
    }
    getAllLookupBycategoryID(categoryid) {
        return this.httpService.get(MasterURL.EndPoints.lookup.getAllLookupByCategoryId.replace('{categoryId}', categoryid));
    }
    addOrUpdateLookup(lookup) {
        return this.httpService.post(MasterURL.EndPoints.lookup.addOrUpdateLookup, lookup);
    }
    updateLookupOrder(lookup, sortOrder) {
        return this.httpService.put((MasterURL.EndPoints.lookup.updateLookupOrders.replace('{sortOrder}', sortOrder)), lookup);
    }
}
RbacService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: RbacService, deps: [{ token: i1.DataStoreService }], target: i0.ɵɵFactoryTarget.Injectable });
RbacService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: RbacService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: RbacService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return [{ type: i1.DataStoreService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmJhYy5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvcGljcy1jb3JlL21hc3RlcmRhdGEvc3JjL2xpYi9waWNzLW1hc3RlcmRhdGEvQGNvcmUvc2VydmljZS9yYmFjLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDckMsT0FBTyxFQUFFLHNCQUFzQixFQUFFLGdCQUFnQixFQUFFLFNBQVMsRUFBRSxjQUFjLEVBQUUsaUJBQWlCLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxNQUFNLDJCQUEyQixDQUFDOzs7QUFNM0osTUFBTSxPQUFPLFdBQVc7SUFFdEIsWUFBb0IsWUFBNkI7UUFBN0IsaUJBQVksR0FBWixZQUFZLENBQWlCO1FBQy9DLElBQUksQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUEsRUFBRTtZQUM1QyxJQUFHLEdBQUcsRUFBQztnQkFDTCxJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUE7YUFDbkM7UUFDSCxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxjQUFjLENBQUMsR0FBWTtRQUN6QixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsY0FBYyxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDbkYsQ0FBQztJQUNELGlCQUFpQixDQUFDLEtBQVU7UUFDMUIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUNsRixDQUFDO0lBQ0QsUUFB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QUMsVUFBZTtRQUNuQyxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUM1RyxDQUFDO0lBRUQsd0JBQXdCLENBQUMsVUFBZTtRQUN0QyxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLHdCQUF3QixDQUFDLE9BQU8sQ0FBQyxjQUFjLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUN2SCxDQUFDO0lBRUQsaUJBQWlCLENBQUMsTUFBVztRQUMzQixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3JGLENBQUM7SUFFRCxpQkFBaUIsQ0FBQyxNQUFXLEVBQUUsU0FBYztRQUMzQyxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxTQUFTLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3pILENBQUM7O3lHQXRPVSxXQUFXOzZHQUFYLFdBQVcsY0FGVixNQUFNOzRGQUVQLFdBQVc7a0JBSHZCLFVBQVU7bUJBQUM7b0JBQ1YsVUFBVSxFQUFFLE1BQU07aUJBQ25CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVHJlZU5vZGUgfSBmcm9tICdwcmltZW5nL2FwaSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBBY2Nlc3NNYW5hZ2VtZW50Q29uZmlnLCBBdHRhY2htZW50Q29uZmlnLCBNYXN0ZXJVUkwsIFBlcm1pc3Npb25zVVJMLCBQb2xpY3lHcm91cENvbmZpZywgUm9sZUNvbmZpZywgVXNlckNvbmZpZyB9IGZyb20gJy4vLi4vdXJscy9yYmFjLXVybC5jb25maWcnO1xuaW1wb3J0IHsgRGF0YVN0b3JlU2VydmljZSB9IGZyb20gJy4vZGF0YS1zdG9yZS5zZXJ2aWNlJztcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgUmJhY1NlcnZpY2Uge1xuICBodHRwU2VydmljZTphbnlcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzdG9yZVNlcnZpY2U6RGF0YVN0b3JlU2VydmljZSkge1xuICAgIHRoaXMuc3RvcmVTZXJ2aWNlLmN1cnJlbnRTdG9yZS5zdWJzY3JpYmUodmFsPT57XG4gICAgICBpZih2YWwpe1xuICAgICAgICB0aGlzLmh0dHBTZXJ2aWNlID0gdmFsLkhUVFBTRVJWSUNFXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGdldEFsbFVzZXJMaXN0KGtleT86IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KGAke1VzZXJDb25maWcuRW5kUG9pbnQuVXNlci5nZXRBbGxVc2VyTGlzdH0vJHtrZXl9YCk7XG4gIH1cbiAgZ2V0QWxsVXNlck9yZ0xpc3Qob3JnaWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChVc2VyQ29uZmlnLkVuZFBvaW50LlVzZXIuZ2V0QWxsVXNlck9yZ0xpc3QgKyBvcmdpZCk7XG4gIH1cbiAgc2F2ZVVzZXIoZGF0YTogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucG9zdChVc2VyQ29uZmlnLkVuZFBvaW50LlVzZXIuY3JlYXRlVXNlciwgZGF0YSk7XG4gIH1cbiAgdXBkYXRlVXNlcihkYXRhOiBhbnksIHVzZXJpZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucHV0KGAke1VzZXJDb25maWcuRW5kUG9pbnQuVXNlci5nZXRBbGxVc2VyTGlzdH0vJHt1c2VyaWR9YCwgZGF0YSk7XG4gIH1cbiAgZGVsZXRlVXNlcihpZD86IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmRlbGV0ZShgJHtVc2VyQ29uZmlnLkVuZFBvaW50LlVzZXIuZ2V0QWxsVXNlckxpc3R9LyR7aWR9YCk7XG4gIH1cbiAgYWN0aXZhdGVVc2VyKGRhdGE6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoVXNlckNvbmZpZy5FbmRQb2ludC5Vc2VyLmFjdGl2YXRlVXNlciwgZGF0YSk7XG4gIH1cbiAgYWRkUHJvdmlkZXJVc2VyKGRhdGE6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoVXNlckNvbmZpZy5FbmRQb2ludC5Qcm92aWRlci5hZGRQcm92aWRlclVzZXIsIGRhdGEpO1xuICB9XG4gIGFkZFVzZXJSb2xlKGRhdGE6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoVXNlckNvbmZpZy5FbmRQb2ludC5Vc2VyLnVzZXJSb2xlLCBkYXRhKTtcbiAgfVxuICB1cGxvYWRLZXkob2JqcGFyYW1zOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wb3N0KEF0dGFjaG1lbnRDb25maWcuRW5kUG9pbnQuQXR0YWNobWVudHMuVXBsb2FkS2V5LCBvYmpwYXJhbXMpO1xuICB9XG4gIGdldE9yZ1BvbGljeUdyb3VwTGlzdChvcmdpZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KFxuICAgICAgUG9saWN5R3JvdXBDb25maWcuRW5kUG9pbnQucG9saWN5R3JvdXAuZ2V0T3JnUG9saWN5R3JvdXBzLnJlcGxhY2UoJ3tvcmdhbml6YXRpb25pZH0nLCBTdHJpbmcob3JnaWQpKVxuICAgICk7XG4gIH1cbiAgZ2V0QWxsUG9saWN5R3JvdXBMaXN0KHBvbGljeUdyb3VwSWQ/OiBudW1iZXIpIHtcbiAgICBjb25zdCBlbmRQb2ludCA9IHBvbGljeUdyb3VwSWRcbiAgICAgID8gYCR7UG9saWN5R3JvdXBDb25maWcuRW5kUG9pbnQucG9saWN5R3JvdXAuZ2V0UG9saWN5R3JvdXBMaXN0fS8ke3BvbGljeUdyb3VwSWR9YFxuICAgICAgOiBQb2xpY3lHcm91cENvbmZpZy5FbmRQb2ludC5wb2xpY3lHcm91cC5nZXRBbGxQb2xpY3lHcm91cExpc3Q7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KGVuZFBvaW50KTtcbiAgfVxuICBnZXRQb2xpY3lHcm91cEJ5SWQoaWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChQb2xpY3lHcm91cENvbmZpZy5FbmRQb2ludC5wb2xpY3lHcm91cC5nZXRQb2xpY3lHcm91cExpc3QgKyAnLycgKyBpZCk7XG4gIH1cblxuICBnZXRQb2xpY3lHcm91cHNCeU1hbmFnZW1lbnRHcm91cChwb2xpY3lHcm91cElkOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5nZXQoYC9vcmcvcG9saWN5R3JvdXAvbWFuYWdlbWVudGdyb3VwLyR7cG9saWN5R3JvdXBJZH1gKTtcbiAgfVxuXG4gIGNyZWF0ZVBvbGljeUdyb3VwKGRhdGE6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoUG9saWN5R3JvdXBDb25maWcuRW5kUG9pbnQucG9saWN5R3JvdXAuY3JlYXRlUG9saWN5R3JvdXAsIGRhdGEpO1xuICB9XG5cbiAgdXBkYXRlUG9saWN5R3JvdXAoaWQ6IG51bWJlciwgaXRlbTogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucHV0KGAke1BvbGljeUdyb3VwQ29uZmlnLkVuZFBvaW50LnBvbGljeUdyb3VwLmdldFBvbGljeUdyb3VwTGlzdH0vJHtpZH1gLCBpdGVtKTtcbiAgfVxuXG4gIGRlbGV0ZVBvbGljeUdyb3VwKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5kZWxldGUoYCR7UG9saWN5R3JvdXBDb25maWcuRW5kUG9pbnQucG9saWN5R3JvdXAuZ2V0UG9saWN5R3JvdXBMaXN0fS8ke2lkfWApO1xuICB9XG4gIGdldEFsbFVzZXJSb2xlKGlkPzogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KFJvbGVDb25maWcuRW5kUG9pbnQucm9sZS5nZXRBbGxPcmdSb2xlLnJlcGxhY2UoJ3tvcmdpZH0nLCBTdHJpbmcoaWQpKSk7XG4gIH1cblxuICBkZWxldGVSb2xlKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5kZWxldGUoYCR7Um9sZUNvbmZpZy5FbmRQb2ludC5yb2xlLmdldEFsbFVzZXJSb2xlfS8ke2lkfWApO1xuICB9XG5cbiAgZ2V0Um9sZUJ5SWQocm9sZWlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5nZXQoYCR7Um9sZUNvbmZpZy5FbmRQb2ludC5yb2xlLmdldEFsbFVzZXJSb2xlfS8ke3JvbGVpZH1gKTtcbiAgfVxuXG4gIGNyZWF0ZVJvbGUoZGF0YTogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucG9zdChSb2xlQ29uZmlnLkVuZFBvaW50LnJvbGUuY3JlYXRlUm9sZSwgZGF0YSk7XG4gIH1cblxuICB1cGRhdGVSb2xlKHJvbGVJZDogYW55LCBkYXRhOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wdXQoYCR7Um9sZUNvbmZpZy5FbmRQb2ludC5yb2xlLmdldEFsbFVzZXJSb2xlfS8ke3JvbGVJZH1gLCBkYXRhKTtcbiAgfVxuXG4gIGdldExhbmRpbmdQYWdlKGlkOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5nZXQoYCR7Um9sZUNvbmZpZy5FbmRQb2ludC5yb2xlLmdldExhbmRpbmdQYWdlfS8ke2lkfWApO1xuICB9XG5cbiAgY3JlYXRlUG9saWN5R3JvdXBGb3JSb2xlKHJvbGVJZDogbnVtYmVyLCBkYXRhOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wb3N0KGAke1JvbGVDb25maWcuRW5kUG9pbnQucm9sZS5hZGRQb2xpY3lHcm91cH0vJHtyb2xlSWR9L3BvbGljeWdyb3Vwc2AsIGRhdGEpO1xuICB9XG5cbiAgdXBkYXRlUG9saWN5R3JvdXBGb3JSb2xlKHJvbGVJZDogbnVtYmVyLCBkYXRhOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wdXQoYCR7Um9sZUNvbmZpZy5FbmRQb2ludC5yb2xlLmFkZFBvbGljeUdyb3VwfS8ke3JvbGVJZH0vcG9saWN5Z3JvdXBzYCwgZGF0YSk7XG4gIH1cbiAgZ2V0UmVwb3J0RGFzaGJhb3JkKCkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChgJHtSb2xlQ29uZmlnLkVuZFBvaW50LnJvbGUuZG9zc2llcn1gKTtcbiAgfVxuICBnZXRQZXJtaXNzaW9uUm9sZUJ5SWQoaWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChQZXJtaXNzaW9uc1VSTC5FbmRQb2ludHMucGVybWlzc2lvbi5wZXJtaXNzaW9uUm9sZUJ5SWQucmVwbGFjZSgne2lkfScsIGlkKSk7XG4gIH1cbiAgZ2V0TWFuYWdlbWVudEdyb3VwVHJlZShfb3JnYW5pemF0aW9uaWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldCgnL29yZy9tYW5hZ2VtZW50LWdyb3VwL29yZ2FuaXphdGlvbi90cmVlJyk7XG4gIH1cbiAgZ2V0UGVybWlzc2lvbnNUcmVlKGFwcGxpY2F0aW9uaWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChcbiAgICAgIFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wZXJtaXNzaW9uLmFwcGxpY2F0aW9uUGVybWlzc2lvbnNUcmVlLnJlcGxhY2UoJ3thcHBsaWNhdGlvbmlkfScsIGFwcGxpY2F0aW9uaWQpXG4gICAgKTtcbiAgfVxuXG4gIGdldFBhZ2VQZXJtaXNzaW9uKGRhdGE6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoUGVybWlzc2lvbnNVUkwuRW5kUG9pbnRzLnBlcm1pc3Npb24ucGFnZVBlcm1pc3Npb24sIGRhdGEpO1xuICB9XG5cbiAgY3JlYXRlUGFnZShwYWdlOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wb3N0KFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wYWdlLmNyZWF0ZVBhZ2UsIHBhZ2UpO1xuICB9XG5cbiAgdXBkYXRlUGFnZShwYWdlOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wdXQoUGVybWlzc2lvbnNVUkwuRW5kUG9pbnRzLnBhZ2UudXBkYXRlRGVsZXRlUGFnZS5yZXBsYWNlKCd7cGFnZWlkfScsIHBhZ2UuaWQpLCBwYWdlKTtcbiAgfVxuXG4gIGRlbGV0ZVBhZ2UocGFnZUlkOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5kZWxldGUoUGVybWlzc2lvbnNVUkwuRW5kUG9pbnRzLnBhZ2UudXBkYXRlRGVsZXRlUGFnZS5yZXBsYWNlKCd7cGFnZWlkfScsIHBhZ2VJZCkpO1xuICB9XG5cbiAgZ2V0UGVybWlzc2lvbihpZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wZXJtaXNzaW9uLmdldFBlcm1pc3Npb24ucmVwbGFjZSgne2lkfScsIGlkKSk7XG4gIH1cblxuICBjcmVhdGVQZXJtaXNzaW9uKHBlcm1pc3Npb246IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoUGVybWlzc2lvbnNVUkwuRW5kUG9pbnRzLnBlcm1pc3Npb24uY3JlYXRlUGVybWlzc2lvbiwgcGVybWlzc2lvbik7XG4gIH1cblxuICB1cGRhdGVQZXJtaXNzaW9uKHBlcm1pc3Npb246IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnB1dChcbiAgICAgIFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wZXJtaXNzaW9uLnVwZGF0ZURlbGV0ZVBlcm1pc3Npb24ucmVwbGFjZSgne3Blcm1pc3Npb25pZH0nLCBwZXJtaXNzaW9uLmlkKSxcbiAgICAgIHBlcm1pc3Npb25cbiAgICApO1xuICB9XG5cbiAgZGVsZXRlUGVybWlzc2lvbihwZXJtaXNzaW9uSWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmRlbGV0ZShcbiAgICAgIFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wZXJtaXNzaW9uLnVwZGF0ZURlbGV0ZVBlcm1pc3Npb24ucmVwbGFjZSgne3Blcm1pc3Npb25pZH0nLCBwZXJtaXNzaW9uSWQpXG4gICAgKTtcbiAgfVxuXG4gIGdldEFsbFBhZ2VUcmVlKGFwcGxpY2F0aW9uaWQ6IGFueSk6IE9ic2VydmFibGU8VHJlZU5vZGVbXT4ge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlXG4gICAgICAuZ2V0KFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wYWdlLkFsbFBhZ2VUcmVlLnJlcGxhY2UoJ3thcHBsaWNhdGlvbmlkfScsIGFwcGxpY2F0aW9uaWQpKVxuICAgICAgLnBpcGUoXG4gICAgICAgIG1hcCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0uZGF0YSBhcyBUcmVlTm9kZVtdO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgfVxuXG4gIGdldFBlcm1pc3Npb25UcmVlKHBhZ2VpZDogYW55LCBwYXJlbnRpZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KFxuICAgICAgUGVybWlzc2lvbnNVUkwuRW5kUG9pbnRzLnBlcm1pc3Npb24uZ2V0UGVybWlzc2lvblRyZWUucmVwbGFjZSgne3BhZ2VpZH0nLCBwYWdlaWQpLnJlcGxhY2UoJ3twYXJlbnRpZH0nLCBwYXJlbnRpZClcbiAgICApO1xuICB9XG5cbiAgZ2V0UGVybWlzc2lvblR5cGVzKGFwcGxpY2F0aW9uaWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChcbiAgICAgIFBlcm1pc3Npb25zVVJMLkVuZFBvaW50cy5wZXJtaXNzaW9uLmdldFBlcm1pc3Npb25UeXBlcy5yZXBsYWNlKCd7YXBwbGljYXRpb25pZH0nLCBhcHBsaWNhdGlvbmlkKVxuICAgICk7XG4gIH1cbiAgZ2V0T3JnYW5pemF0aW9uUGFnZShvcmdJZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KEFjY2Vzc01hbmFnZW1lbnRDb25maWcuRW5kUG9pbnQuT3JnYW5pemF0aW9uLmdldE9yZ2FuaXphdGlvbi5yZXBsYWNlKCd7b3JnSWR9Jywgb3JnSWQpKTtcbiAgfVxuICBjcmVhdGVDYXRlZ29yeShjYXRlZ29yeTogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucG9zdChNYXN0ZXJVUkwuRW5kUG9pbnRzLmxvb2t1cC5jcmVhdGVDYXRlZ29yeSwgY2F0ZWdvcnkpO1xuICB9XG5cbiAgdXBkYXRlQ2F0ZWdvcnkoY2F0ZWdvcnk6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnB1dChNYXN0ZXJVUkwuRW5kUG9pbnRzLmxvb2t1cC51cGRhdGVEZWxldGVDYXRlZ29yeS5yZXBsYWNlKCd7aWR9JywgY2F0ZWdvcnkuaWQpLCBjYXRlZ29yeSk7XG4gIH1cblxuICBkZWxldGVDYXRlZ29yeShjYXRlZ29yeUlkOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5kZWxldGUoTWFzdGVyVVJMLkVuZFBvaW50cy5sb29rdXAudXBkYXRlRGVsZXRlQ2F0ZWdvcnkucmVwbGFjZSgne2lkfScsIGNhdGVnb3J5SWQpKTtcbiAgfVxuXG4gIGdldExvb2t1cChpZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KE1hc3RlclVSTC5FbmRQb2ludHMubG9va3VwLmxvb2t1cC5yZXBsYWNlKCd7aWR9JywgaWQpKTtcbiAgfVxuXG4gIGNyZWF0ZUxvb2t1cChsb29rdXA6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnBvc3QoTWFzdGVyVVJMLkVuZFBvaW50cy5sb29rdXAuY3JlYXRlTG9va3VwLCBsb29rdXApO1xuICB9XG5cbiAgdXBkYXRlTG9va3VwKGxvb2t1cDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucHV0KE1hc3RlclVSTC5FbmRQb2ludHMubG9va3VwLmxvb2t1cC5yZXBsYWNlKCd7aWR9JywgbG9va3VwLmlkKSwgbG9va3VwKTtcbiAgfVxuXG4gIGRlbGV0ZUxvb2t1cChsb29rdXBJZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZGVsZXRlKE1hc3RlclVSTC5FbmRQb2ludHMubG9va3VwLmxvb2t1cC5yZXBsYWNlKCd7aWR9JywgbG9va3VwSWQpKTtcbiAgfVxuXG4gIGdldEFsbENhdGVnb3J5VHJlZShhcHBsaWNhdGlvbmlkOiBhbnkpOiBPYnNlcnZhYmxlPFRyZWVOb2RlW10+IHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZVxuICAgICAgLmdldChNYXN0ZXJVUkwuRW5kUG9pbnRzLmxvb2t1cC5nZXRBbGxDYXRlZ29yeVRyZWUucmVwbGFjZSgne2FwcGxpY2F0aW9uaWR9JywgYXBwbGljYXRpb25pZCkpXG4gICAgICAucGlwZShcbiAgICAgICAgbWFwKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbS5kYXRhIGFzIFRyZWVOb2RlW107XG4gICAgICAgIH0pXG4gICAgICApO1xuICB9XG5cbiAgZ2V0TG9va3VwVHJlZShjYXRlZ29yeWlkOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5nZXQoTWFzdGVyVVJMLkVuZFBvaW50cy5sb29rdXAuZ2V0TG9va3VwVHJlZS5yZXBsYWNlKCd7Y2F0ZWdvcnlpZH0nLCBjYXRlZ29yeWlkKSk7XG4gIH1cblxuICBnZXRMb29rdXBCeWNhdGVnb3J5SUQoY2F0ZWdvcnlpZDogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UuZ2V0KE1hc3RlclVSTC5FbmRQb2ludHMubG9va3VwLmdldExvb2t1cEJ5Q2F0ZWdvcnlJZC5yZXBsYWNlKCd7aWR9JywgY2F0ZWdvcnlpZCkpO1xuICB9XG5cbiAgZ2V0QWxsTG9va3VwQnljYXRlZ29yeUlEKGNhdGVnb3J5aWQ6IGFueSkge1xuICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLmdldChNYXN0ZXJVUkwuRW5kUG9pbnRzLmxvb2t1cC5nZXRBbGxMb29rdXBCeUNhdGVnb3J5SWQucmVwbGFjZSgne2NhdGVnb3J5SWR9JywgY2F0ZWdvcnlpZCkpO1xuICB9XG5cbiAgYWRkT3JVcGRhdGVMb29rdXAobG9va3VwOiBhbnkpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5wb3N0KE1hc3RlclVSTC5FbmRQb2ludHMubG9va3VwLmFkZE9yVXBkYXRlTG9va3VwLCBsb29rdXApO1xuICB9XG5cbiAgdXBkYXRlTG9va3VwT3JkZXIobG9va3VwOiBhbnksIHNvcnRPcmRlcjogYW55KSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucHV0KChNYXN0ZXJVUkwuRW5kUG9pbnRzLmxvb2t1cC51cGRhdGVMb29rdXBPcmRlcnMucmVwbGFjZSgne3NvcnRPcmRlcn0nLCBzb3J0T3JkZXIpKSwgbG9va3VwKTtcbiAgfVxufVxuIl19